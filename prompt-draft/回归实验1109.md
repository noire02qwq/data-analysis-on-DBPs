# 回归实验

## 回归实验

使用MLP、MLP_with_history、XGBoost、LSTM、RNN尝试回归实验。原始数据使用time_aligned_data.csv。模型输出目标是PPL1和PPL2的TRC, TOC, DOC，PH，非PPL1 PPL2的值为输入数据。训验测划分为7:1.5:1.5。

按每个模型来详细定义输入数据：MLP和XGBoost直接使用非PPL1 PPL2的值为输入数据，MLP_with_history把该时间步与过去固定长度时间步的非PPL1 PPL2数据展平作为模型的输入数据(类比1027的MLP)。LSTM和RNN中，某时间步的输入数据为该时间步的非PPL1 PPL2数据。框架使用torch。

其中：模型本体放在models中，模型超参数配置文件yaml放在models/configs中，训练、测试脚本放在scripts中，要支持加载不同模型。模型训练时每10个epoch保存checkpoint，并在train loss降到初始1/3后使用val loss新低更新best模型。80轮epoch后开始判定停止：当连续50个epoch中val loss或train loss不出现新低(只记录train loss降到1/3后或31轮后的值(先出现的为准)，也就是初val loss始最低值为best模型的或第30轮的)则停止训练而不是设置固定epoch轮数。如果50轮epoch后train loss降不到初始1/3也提前结束，把最后一个epoch作为best。超参数等根据数据规模采取经验值。训练脚本最终要生成训练曲线，测试脚本要生成真实值和预测值的对比折线图(每个输出目标一张图两条线)。训练和测试脚本产生的文件放在scripts/outputs/模型名称中。
