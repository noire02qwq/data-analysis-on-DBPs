# 缺失填充

原始数据文件为data/raw_data.csv，其中标题带-PPL1, -PPL2后缀的列是有缺失的，请为我在scripts中生成py程序进行填充，新表格输出到data中，以下为填充规则。

- 如果某一段空缺前后都有数据，则以前后整段的数据作为参考(如6-10行空缺，1-5行和11-15行有数据，16行空缺，则参考1-5行和11-15行)
    - 把前后两段的数据分别进行线型回归
    - 把前段末值的回归估计值和后端首值的回归估计值进行连线，对应空缺中段的值为填充的初始值
    - 在连线对应的初值基础上，取前后两段线性回归后方差较小值作为中段的方差进行随机波动
- 如果空缺段在首段或尾端，则以最近的整段数据为参考(如1-5行空缺, 6-10行有数据, 则参考6-10行)
    - 把参考段进行线型回归
    - 把参考段的回归直线在空缺段上延长，对应的值为填充初始值
    - 把参考段回归的方差作为缺失段的方差进行随机波动